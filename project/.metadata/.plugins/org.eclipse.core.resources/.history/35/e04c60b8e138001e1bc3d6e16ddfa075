<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-compatible" content="IE=Edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>아이디 찾기</title>
    <style>
        .box { width: 150px; height: 50px; border:1px solid #ccc; }
    </style>
</head>
<body>
	
<!-- 응용문제 3번-->

[아이디 찾기]
이름 : <input type="text" id="usernm">
이메일 : <input type="text" id="useremail">
<input type="button" value="아이디 찾기" onclick="id_search()" >
<br><br>
아이디명 : <div class="box" id="box"></div>
<script>
	//form태그 없을때 스크립트로 바로 해결하는 방법!!
	//form 없을땐 input태그의 name 값을 사용을 못함
	
	/* 이름이 없는경우, 이메일이 없는경우 알림창, 띄우고 ajax이용하여 통신하는방법!*/
	function id_search(){
		var nm = document.getElementById("usernm");
		var em = document.getElementById("useremail");
		if(nm.value==""){
			alert("이름이 없습니다.");
		}
		else if(em.value==""){
			alert("이메일을 입력하셔야 됩니다");
		}
		else{
			ajax(nm.value,em.value);
		}
		
		//ajax 통신에 관한 함수 정의
		function ajax(a,b){
			//ajax함수로 넘길껀데 응답받아야 하는 변수,통신변수를 선언해야함
			var info; // ajax 통신변수			
			// 응답 받는 결과에 대한 변수
			var postdata = "usernm=" + a + "userem=" + b //여기서 a와 b는 각각 nm.value, em.value 이다
			
			function wk(){
				if(window.XMLHttpRequest){
					return new XMLHttpRequest;
				}
			}
			function id_search(){
				if(info.readyState==XMLHttpRequest.DONE && info.status==200){
					var result = this.response;
					if(result == "error"){
						alert("해당 정보를 확인하지 못하였습니다.");
					}
					else{
						var html = document.getElementById("box");
						html.innerHTML = "<p>" + result + "</p>";
						html.append(result);
					}
				}
			}
			info = wk();
			info.onreadystatechange = id_search;
			info.open("POST","./idsearch.do",true);
			info.setRequestHeader("content-type","application/x-www-form-urlencoded",true);
			info.send(postdata);
			//응용문제 4번:
		}
		
		
	}
</script>

</body>
</html>